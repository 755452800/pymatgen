---
layout: default
title: pymatgen.io.lobster.outputs.md
nav_exclude: true
---

# pymatgen.io.lobster.outputs module

Module for reading Lobster output files. For more information
on LOBSTER see www.cohp.de.
If you use this module, please cite:
J. George, G. Petretto, A. Naik, M. Esters, A. J. Jackson, R. Nelson, R. Dronskowski, G.-M. Rignanese, G. Hautier,
“Automated Bonding Analysis with Crystal Orbital Hamilton Populations”,
ChemPlusChem 2022, e202200123,
DOI: 10.1002/cplu.202200123.


### _class_ pymatgen.io.lobster.outputs.Bandoverlaps(filename: str = 'bandOverlaps.lobster')
Bases: `object`

Class to read in bandOverlaps.lobster files. These files are not created during every Lobster run.
.. attribute: bandoverlapsdict is a dict of the following form:

> {spin:{“kpoint as string”: {“maxDeviation”: float that describes the max deviation, “matrix”: 2D
> array of the size number of bands times number of bands including the overlap matrices with } }}.

<!-- attribute: maxDeviation is a list of floats describing the maximal Deviation for each problematic kpoint -->

* **Parameters**

    **filename** – filename of the “bandOverlaps.lobster” file.



#### has_good_quality_check_occupied_bands(number_occ_bands_spin_up: int, number_occ_bands_spin_down: int | None = None, spin_polarized: bool = False, limit_deviation: float = 0.1)
Will check if the deviation from the ideal bandoverlap of all occupied bands is smaller or equal to
limit_deviation.

Args:
number_occ_bands_spin_up (int): number of occupied bands of spin up
number_occ_bands_spin_down (int): number of occupied bands of spin down
spin_polarized (bool):  If True, then it was a spin polarized calculation
limit_deviation (float): limit of the maxDeviation
:returns: Boolean that will give you information about the quality of the projection


#### has_good_quality_maxDeviation(limit_maxDeviation: float = 0.1)
Will check if the maxDeviation from the ideal bandoverlap is smaller or equal to limit_maxDeviation
:param limit_maxDeviation: limit of the maxDeviation


* **Returns**

    Boolean that will give you information about the quality of the projection.



### _class_ pymatgen.io.lobster.outputs.Charge(filename: str = 'CHARGE.lobster')
Bases: `object`

Class to read CHARGE files generated by LOBSTER.

<!-- attribute: atomlist
List of atoms in CHARGE.lobster -->
<!-- attribute: types
List of types of atoms in CHARGE.lobster -->
<!-- attribute: Mulliken
List of Mulliken charges of atoms in CHARGE.lobster -->
<!-- attribute: Loewdin
List of Loewdin charges of atoms in CHARGE.Loewdin -->
<!-- attribute: num_atoms
Number of atoms in CHARGE.lobster -->

* **Parameters**

    **filename** – filename for the CHARGE file, typically “CHARGE.lobster”.



#### get_structure_with_charges(structure_filename)
Get a Structure with Mulliken and Loewdin charges as site properties
:param structure_filename: filename of POSCAR


* **Returns**

    Structure Object with Mulliken and Loewdin charges as site properties.



### _class_ pymatgen.io.lobster.outputs.Cohpcar(are_coops: bool = False, are_cobis: bool = False, filename: str | None = None)
Bases: `object`

Class to read COHPCAR/COOPCAR files generated by LOBSTER.

<!-- attribute: cohp_data

Dict that contains the COHP data of the form:
  {bond: {"COHP": {Spin.up: cohps, Spin.down:cohps},
          "ICOHP": {Spin.up: icohps, Spin.down: icohps},
          "length": bond length,
          "sites": sites corresponding to the bond}
Also contains an entry for the average, which does not have
a "length" key. -->
<!-- attribute: efermi

The Fermi energy in eV. -->
<!-- attribute: energies

Sequence of energies in eV. Note that LOBSTER shifts the energies
so that the Fermi energy is at zero. -->
<!-- attribute: is_spin_polarized

Boolean to indicate if the calculation is spin polarized. -->
<!-- attribute: orb_cohp

orb_cohp[label] = {bond_data["orb_label"]: {"COHP": {Spin.up: cohps, Spin.down:cohps},
                                             "ICOHP": {Spin.up: icohps, Spin.down: icohps},
                                             "orbitals": orbitals,
                                             "length": bond lengths,
                                             "sites": sites corresponding to the bond}} -->

* **Parameters**


    * **are_coops** – Determines if the file is a list of COHPs or COOPs.
    Default is False for COHPs.


    * **are_cobis** – Determines if the file is a list of COHPs or COOPs.
    Default is False for COHPs.


    * **filename** – Name of the COHPCAR file. If it is None, the default
    file name will be chosen, depending on the value of are_coops.



### _class_ pymatgen.io.lobster.outputs.Doscar(doscar: str = 'DOSCAR.lobster', structure_file: str | None = 'POSCAR', structure: [IStructure](pymatgen.core.structure.md#pymatgen.core.structure.IStructure) | [Structure](pymatgen.core.structure.md#pymatgen.core.structure.Structure) | None = None)
Bases: `object`

Class to deal with Lobster’s projected DOS and local projected DOS.
The beforehand quantum-chemical calculation was performed with VASP.


#### completedos()
LobsterCompleteDos Object


#### pdos()

### List of Dict including numpy arrays with pdos. Access as pdos[atomindex]['orbitalstring']['Spin.up/Spin.down']()

#### tdos()

### Dos Object of the total density of states()

#### energies()

### numpy array of the energies at which the DOS was calculated (in eV, relative to Efermi)()

#### tdensities()

### tdensities[Spin.up]: numpy array of the total density of states for the Spin.up contribution at each of the()

#### energies()

### tdensities[Spin.down]: numpy array of the total density of states for the Spin.down contribution at each of the()

#### energies()
if is_spin_polarized=False:
tdensities[Spin.up]: numpy array of the total density of states


### itdensities:()

### itdensities[Spin.up]: numpy array of the total density of states for the Spin.up contribution at each of the()

#### energies()

### itdensities[Spin.down]: numpy array of the total density of states for the Spin.down contribution at each of the()

#### energies()
if is_spin_polarized=False:
itdensities[Spin.up]: numpy array of the total density of states


#### is_spin_polarized()

### Boolean. Tells if the system is spin polarized()

* **Parameters**


    * **doscar** – DOSCAR filename, typically “DOSCAR.lobster”


    * **structure_file** – for vasp, this is typically “POSCAR”


    * **structure** – instead of a structure file, the structure can be given
    directly. structure_file will be preferred.



#### _property_ completedos(_: [LobsterCompleteDos](pymatgen.electronic_structure.dos.md#pymatgen.electronic_structure.dos.LobsterCompleteDos_ )
CompleteDos


* **Type**

    return



#### _property_ energies(_: ndarra_ )
Energies


* **Type**

    return



#### _property_ is_spin_polarized(_: boo_ )
Whether run is spin polarized.


* **Type**

    return



#### _property_ itdensities(_: ndarra_ )
integrated total densities as a np.ndarray


* **Type**

    return



#### _property_ pdos(_: lis_ )
Projected DOS


* **Type**

    return



#### _property_ tdensities(_: ndarra_ )
total densities as a np.ndarray


* **Type**

    return



#### _property_ tdos(_: [Dos](pymatgen.electronic_structure.dos.md#pymatgen.electronic_structure.dos.Dos_ )
Total DOS


* **Type**

    return



### _class_ pymatgen.io.lobster.outputs.Fatband(filenames='.', vasprun='vasprun.xml', Kpointsfile='KPOINTS')
Bases: `object`

Reads in FATBAND_x_y.lobster files.

<!-- attribute: efermi

efermi that was read in from vasprun.xml -->
<!-- attribute: eigenvals
{Spin.up:[][],Spin.down:[][]}, the first index of the array
    [][] refers to the band and the second to the index of the
    kpoint. The kpoints are ordered according to the order of the
    kpoints array. If the band structure is not spin polarized, we
    only store one data set under Spin.up. -->
<!-- attribute: is_spinpolarized

Boolean that tells you whether this was a spin-polarized calculation -->
<!-- attribute: kpoints_array

list of kpoint as numpy arrays, in frac_coords of the given lattice by default -->
<!-- attribute: label_dict

(dict) of {} this link a kpoint (in frac coords or Cartesian coordinates depending on the coords). -->
<!-- attribute: lattice

lattice object of reciprocal lattice as read in from vasprun.xml -->
<!-- attribute: nbands

number of bands used in the calculation -->
<!-- attribute: p_eigenvals

dict of orbital projections as {spin: array of dict}.
The indices of the array are [band_index, kpoint_index].
The dict is then built the following way:
{"string of element": "string of orbital as read in from FATBAND file"}
If the band structure is not spin polarized, we only store one data set under Spin.up. -->
<!-- attribute: structure

structure read in from vasprun.xml -->

* **Parameters**


    * **filenames** (*list** or **string*) – can be a list of file names or a path to a folder folder from which all
    “FATBAND_\*” files will be read


    * **vasprun** – corresponding vasprun file


    * **Kpointsfile** – KPOINTS file for bandstructure calculation, typically “KPOINTS”.



#### get_bandstructure()
Returns a LobsterBandStructureSymmLine object which can be plotted with a normal BSPlotter.


### _class_ pymatgen.io.lobster.outputs.Grosspop(filename: str = 'GROSSPOP.lobster')
Bases: `object`

Class to read in GROSSPOP.lobster files.

<!-- attribute: list_dict_grosspop
which is a list of dicts including all information about the grosspopulations, one sample dict looks like this:
 {'element': 'O', 'Mulliken GP': {'2s': '1.80', '2p_y': '1.83', '2p_z': '1.79', '2p_x': '1.75', 'total': '7.18'},
  'Loewdin GP': {'2s': '1.60', '2p_y': '1.82', '2p_z': '1.77', '2p_x': '1.73', 'total': '6.92'}}
 The 0. entry of the list refers to the first atom in GROSSPOP.lobster and so on. -->

* **Parameters**

    **filename** – filename of the “GROSSPOP.lobster” file.



#### get_structure_with_total_grosspop(structure_filename: str)
Get a Structure with Mulliken and Loewdin total grosspopulations as site properties
:param structure_filename: filename of POSCAR
:type structure_filename: str


* **Returns**

    Structure Object with Mulliken and Loewdin total grosspopulations as site properties.



### _class_ pymatgen.io.lobster.outputs.Icohplist(are_coops: bool = False, are_cobis: bool = False, filename: str | None = None)
Bases: `object`

Class to read ICOHPLIST/ICOOPLIST files generated by LOBSTER.

<!-- attribute: are_coops
Boolean to indicate if the populations are COOPs or COHPs. -->
<!-- attribute: is_spin_polarized
Boolean to indicate if the calculation is spin polarized. -->
<!-- attribute: Icohplist
Dict containing the listfile data of the form:
   {bond: "length": bond length,
          "number_of_bonds": number of bonds
          "icohp": {Spin.up: ICOHP(Ef) spin up, Spin.down: ...}} -->
<!-- attribute: IcohpCollection
IcohpCollection Object -->

* **Parameters**


    * **are_coops** – Determines if the file is a list of ICOOPs.
    Defaults to False for ICOHPs.


    * **are_cobis** – Determines if the file is a list of ICOBIs.
    Defaults to False for ICOHPs.


    * **filename** – Name of the ICOHPLIST file. If it is None, the default
    file name will be chosen, depending on the value of are_coops.



#### _property_ icohpcollection()
IcohpCollection object.


* **Type**

    Returns



#### _property_ icohplist(_: dict[Any, dict[str, Any]_ )
icohplist compatible with older version of this class.


* **Type**

    Returns



### _class_ pymatgen.io.lobster.outputs.Lobsterout(filename='lobsterout')
Bases: `object`

Class to read in the lobsterout and evaluate the spilling, save the basis, save warnings, save infos.

> <!-- attribute: basis_functions
> list of basis functions that were used in lobster run as strings -->
> <!-- attribute: basis_type
> list of basis type that were used in lobster run as strings -->
> <!-- attribute: charge_spilling
> list of charge spilling (first entry: result for spin 1, second entry: result for spin 2 or not present) -->
> <!-- attribute: dft_program
> string representing the dft program used for the calculation of the wave function -->
> <!-- attribute: elements
> list of strings of elements that were present in lobster calculation -->
> <!-- attribute: has_charge
> Boolean, indicates that CHARGE.lobster is present -->
> <!-- attribute: has_cohpcar
> Boolean, indicates that COHPCAR.lobster and ICOHPLIST.lobster are present -->
> <!-- attribute: has_madelung
> Boolean, indicates that SitePotentials.lobster and MadelungEnergies.lobster are present -->
> <!-- attribute: has_coopcar
> Boolean, indicates that COOPCAR.lobster and ICOOPLIST.lobster are present -->
> <!-- attribute: has_cobicar
> Boolean, indicates that COBICAR.lobster and ICOBILIST.lobster are present -->
> <!-- attribute: has_doscar
> Boolean, indicates that DOSCAR.lobster is present -->
> <!-- attribute: has_doscar_lso
> Boolean, indicates that DOSCAR.LSO.lobster is present -->
> <!-- attribute: has_projection
> Boolean, indicates that projectionData.lobster is present -->
> <!-- attribute: has_bandoverlaps
> Boolean, indicates that bandOverlaps.lobster is present -->
> <!-- attribute: has_density_of_energies
> Boolean, indicates that DensityOfEnergy.lobster is present -->
> <!-- attribute: has_fatbands
> Boolean, indicates that fatband calculation was performed -->
> <!-- attribute: has_grosspopulation
> Boolean, indicates that GROSSPOP.lobster is present -->
> <!-- attribute: info_lines
> string with additional infos on the run -->
> <!-- attribute: info_orthonormalization
> string with infos on orthonormalization -->
> <!-- attribute: is_restart_from_projection
> Boolean that indicates that calculation was restartet from existing projection file -->
> <!-- attribute: lobster_version
> string that indicates Lobster version -->
> <!-- attribute: number_of_spins
> Integer indicating the number of spins -->
> <!-- attribute: number_of_threads
> integer that indicates how many threads were used -->
> <!-- attribute: timing
> dict with infos on timing -->
> <!-- attribute: total_spilling
> list of values indicating the total spilling for spin channel 1 (and spin channel 2) -->
> <!-- attribute: warning_lines
> string with all warnings -->

* **Parameters**

    **filename** – filename of lobsterout.



#### get_doc()
Returns: LobsterDict with all the information stored in lobsterout.


### _class_ pymatgen.io.lobster.outputs.MadelungEnergies(filename: str = 'MadelungEnergies.lobster')
Bases: `object`

Class to read MadelungEnergies.lobster files generated by LOBSTER.

<!-- attribute: madelungenergies_Mulliken
float that gives the madelung energy based on the Mulliken approach -->
<!-- attribute: madelungenergies_Loewdin
float that gives the madelung energy based on the Loewdin approach -->
<!-- attribute: ewald_splitting
Ewald Splitting parameter to compute SitePotentials -->

* **Parameters**

    **filename** – filename of the “MadelungEnergies.lobster” file.



### _class_ pymatgen.io.lobster.outputs.SitePotential(filename: str = 'SitePotentials.lobster')
Bases: `object`

Class to read SitePotentials.lobster files generated by LOBSTER.

<!-- attribute: atomlist
List of atoms in SitePotentials.lobster -->
<!-- attribute: types
List of types of atoms in SitePotentials.lobster -->
<!-- attribute: num_atoms
Number of atoms in SitePotentials.lobster -->
<!-- attribute: sitepotentials_Mulliken
List of Mulliken potentials of sites in SitePotentials.lobster -->
<!-- attribute: sitepotentials_Loewdin
List of Loewdin potentials of sites in SitePotentials.lobster -->
<!-- attribute: madelung_Mulliken
float that gives the madelung energy based on the Mulliken approach -->
<!-- attribute: madelung_Loewdin
float that gives the madelung energy based on the Loewdin approach -->
<!-- attribute: ewald_splitting
Ewald Splitting parameter to compute SitePotentials -->

* **Parameters**

    **filename** – filename for the SitePotentials file, typically “SitePotentials.lobster”.



#### get_structure_with_site_potentials(structure_filename)
Get a Structure with Mulliken and Loewdin charges as site properties
:param structure_filename: filename of POSCAR


* **Returns**

    Structure Object with Mulliken and Loewdin charges as site properties.



### _class_ pymatgen.io.lobster.outputs.Wavefunction(filename, structure)
Bases: `object`

Class to read in wave function files from Lobster and transfer them into an object of the type VolumetricData.

<!-- attribute: grid

grid for the wave function [Nx+1,Ny+1,Nz+1] -->
<!-- attribute: points

list of points -->
<!-- attribute: real

list of real part of wave function -->
<!-- attribute: imaginary

list of imaginary part of wave function -->
<!-- attribute: distance

list of distance to first point in wave function file -->

* **Parameters**


    * **filename** – filename of wavecar file from Lobster


    * **structure** – Structure object (e.g., created by Structure.from_file(“”)).



#### get_volumetricdata_density()
Will return a VolumetricData object including the imaginary part of the wave function.

Returns: VolumetricData object


#### get_volumetricdata_imaginary()
Will return a VolumetricData object including the imaginary part of the wave function.

Returns: VolumetricData object


#### get_volumetricdata_real()
Will return a VolumetricData object including the real part of the wave function.

Returns: VolumetricData object


#### set_volumetric_data(grid, structure)
Will create the VolumetricData Objects.


* **Parameters**


    * **grid** – grid on which wavefunction was calculated, e.g. [1,2,2]


    * **structure** – Structure object



#### write_file(filename='WAVECAR.vasp', part='real')
Will save the wavefunction in a file format that can be read by VESTA
This will only work if the wavefunction from lobster was constructed with:
“printLCAORealSpaceWavefunction kpoint 1 coordinates 0.0 0.0 0.0 coordinates 1.0 1.0 1.0 box bandlist 1 2 3 4
5 6 ”
or similar (the whole unit cell has to be covered!).


* **Parameters**


    * **filename** – Filename for the output, e.g., WAVECAR.vasp


    * **part** – which part of the wavefunction will be saved (“real” or “imaginary”)



### pymatgen.io.lobster.outputs.get_orb_from_str(orbs)

* **Parameters**

    **orbs** – list of two str, e.g. [“2p_x”, “3s”].



* **Returns**

    list of tw Orbital objects